@page "{workerShowId?}/{monthShow?}"
@model WorkTimeTable.Pages.IndexModel

@{
    ViewBag.Title = "Главная";
    Layout = "/Pages/Shared/_Layout.cshtml";
}

<form method="post" asp-page-handler="ShowWorker">
    <text>
        Выработка сотрудника 
        <select asp-for="WorkerShowId" 
                asp-items="Model.OptionsWorkers" required>
            <option value="" disabled selected>— Выберите Сотрудника —</option>
        </select>
        за месяц 
        <select asp-for="MonthShow"
                asp-items="Model.OptionsMonths" required>
            <option value="" disabled selected>— Выберите Месяц —</option>
        </select>
    </text>
    <button type="submit" class="btn btn-primary"> Показать </button>
</form>

@if (Model.WorkerShowId != null && Model.MonthShow != null)
{
    <div class="container">

        <p><text>Всего дней в месяце @Model.DaysInMonth, остаток часов в месяце: @Model.HoursByContract</text></p>
        <table class="table table-striped table-bordered">
            <tr><th>Чекбокс</th><th>Номер договора</th><th>Кол-во часов</th></tr>
            @foreach(var timetable in Model.Timetables)
            {
                <tr>
                    <td>
                        <input type="checkbox" name=AreChecked value="@timetable.Id" form="RemoveForm" />
                    </td>
                    <td>@timetable.Contract.Name</td>
                    <td>@timetable.Hours</td>
                    <td>
                        <form method="post" asp-page-handler="Edit">
                            <input type="hidden" name="id" value="@timetable.Id"/>
                            <input name="hours" type="number" step="1" min="0" value="@timetable.Hours" />
                            <button type="submit" class="btn btn-light">Изменить</button>
                        </form>
                    </td>
                </tr>
            }
        </table>

        <form method="post" id="RemoveForm" asp-page-handler="Remove" >
            <button type="submit" class="btn btn-danger">Удалить</button>
        </form>

    </div>

    <p><text>Добавить работу</text></p>

    <form method="post" asp-page-handler="Add">
        <p>
            <select name="contractId" asp-items="Model.OptionsContracts" required>
                <option value="" selected disabled>- Выберите договор -</option> @* тут проверка на null должна быть *@
            </select>
            <input name="hours" type="number" step="1" min="0" placeholder="Кол-во часов" />
            <input type="hidden" name="workerId" value="@Model.WorkerShowId" />
            <input type="hidden" name="month" value="@Model.MonthShow" />
        </p>
        <button type="submit" class="btn btn-success">Добавить</button>
    </form>
}